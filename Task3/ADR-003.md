# ADR-003: Проработка структуры API

**Статус:** ⚠️ На рассмотрении  
**Участники:** Кондрашов Михаил  
**Дата:** 16.08.2025

---

## 1. Контекст

Требуется описать структуру API для сервиса мониторинга на ферме для передачи в разработку.

## 3. Решение

Так как API выглядит универсально для обоих случаев, описываться оно будет единожды. Остальные части систем либо являются готовыми продуктами, либо имеют неизвестную структуру и не могут быть описаны на данном этапе.

Для API выбран фреймворк ASP.NET Core. В силу того, что это MVP, на текущем этапе API будет реализовано через Minimal API (а не, например, через MVC) с использованием паттерна REPR.

API будет разделено на три части: мониторинг хлевов, мониторинг скота, модуль камер. Аутентификация будет проходить через OIDC основного хаба.

Так как в данный момент в API не предполагается ни одной команды и данные предполагается только получать, следует использовать паттерн REPR, при этом обращаться к DbContext'ам следует непосредственно из реализаций эндпоинтов. Причем в качестве MVP можно не делать отдельные DTO и возвращать непосредственно модели из БД (но лучше сразу сделать DTO).

В качестве ORM для доступа к БД используется Entity Framework Core. Технологию для стриминга следует подобрать отдельно, но, как пример, можно использовать live-streaming-server-net.
